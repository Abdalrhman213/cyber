<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>🔐 CyberChef Clone</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <h1>🔓 CyberChef Clone</h1>
        <textarea id="input" placeholder="أدخل البيانات المشفرة هنا..."></textarea>

        <div class="operations">
            <label><input type="checkbox" value="base64"> Base64</label>
            <label><input type="checkbox" value="url"> URL</label>
            <label><input type="checkbox" value="hex"> Hex</label>
            <label><input type="checkbox" value="rot13"> ROT13</label>
        </div>

        <button onclick="run()">تشغيل العمليات</button>

        <h3>🔍 خطوات التنفيذ:</h3>
        <div id="steps"></div>

        <h3>🎉 النتيجة النهائية:</h3>
        <textarea id="result" readonly></textarea>
    </div>

    <script>
        async function run() {
            const input = document.getElementById("input").value;
            const checkboxes = document.querySelectorAll("input[type=checkbox]:checked");
            const steps = Array.from(checkboxes).map(cb => cb.value);

            const res = await fetch("/process", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ input, steps })
            });

            const data = await res.json();
            document.getElementById("result").value = data.result;

            const stepsDiv = document.getElementById("steps");
            stepsDiv.innerHTML = "";
            data.steps.forEach(step => {
                stepsDiv.innerHTML += `<div class="step">
                    <b>${step.method}</b><br>
                    <i>قبل:</i> ${step.before}<br>
                    <i>بعد:</i> ${step.after}<br><hr>
                </div>`;
            });
        }
    </script>
</body>
</html>
