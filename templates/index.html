<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>🔐 CyberChef Clone</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>🔓 CyberChef Clone (JS)</h1>
        <textarea id="input" placeholder="أدخل البيانات المشفرة هنا..."></textarea>

        <div class="operations">
            <label><input type="checkbox" value="base64"> Base64</label>
            <label><input type="checkbox" value="url"> URL</label>
            <label><input type="checkbox" value="hex"> Hex</label>
            <label><input type="checkbox" value="rot13"> ROT13</label>
        </div>

        <button onclick="run()">تشغيل العمليات</button>

        <h3>🔍 خطوات التنفيذ:</h3>
        <div id="steps"></div>

        <h3>🎉 النتيجة النهائية:</h3>
        <textarea id="result" readonly></textarea>
    </div>

    <script>
        function decodeBase64(data) {
            try {
                return atob(data);
            } catch {
                return "[Base64] ❌ خطأ";
            }
        }

        function decodeURL(data) {
            try {
                return decodeURIComponent(data);
            } catch {
                return "[URL] ❌ خطأ";
            }
        }

        function decodeHex(data) {
            try {
                const hex = data.replace(/[^0-9a-fA-F]/g, '');
                let result = '';
                for (let i = 0; i < hex.length; i += 2) {
                    result += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
                }
                return result;
            } catch {
                return "[Hex] ❌ خطأ";
            }
        }

        function decodeRot13(data) {
            return data.replace(/[a-zA-Z]/g, c =>
                String.fromCharCode(
                    (c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26
                )
            );
        }

        const operations = {
            base64: decodeBase64,
            url: decodeURL,
            hex: decodeHex,
            rot13: decodeRot13,
        };

        function run() {
            const input = document.getElementById("input").value;
            const steps = Array.from(document.querySelectorAll("input[type=checkbox]:checked"))
                               .map(cb => cb.value);

            let current = input;
            let outputSteps = "";
            for (let step of steps) {
                const before = current;
                current = operations[step](current);
                outputSteps += `
                    <div class="step">
                        <b>${step.toUpperCase()}</b><br>
                        <i>قبل:</i> ${before}<br>
                        <i>بعد:</i> ${current}<br><hr>
                    </div>
                `;
            }

            document.getElementById("steps").innerHTML = outputSteps;
            document.getElementById("result").value = current;
        }
    </script>
</body>
</html>
