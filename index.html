<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔐 CyberChef Clone</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>🔓 CyberChef Clone</h1>
        <textarea id="input" placeholder="أدخل البيانات المشفرة هنا..."></textarea>

        <div class="operations">
            <label><input type="checkbox" value="base64"> Base64</label>
            <label><input type="checkbox" value="url"> URL</label>
            <label><input type="checkbox" value="hex"> Hex</label>
            <label><input type="checkbox" value="rot13"> ROT13</label>
        </div>

        <button id="runButton">تشغيل العمليات</button>

        <h3>🔍 خطوات التنفيذ:</h3>
        <div id="steps" class="steps"></div>

        <h3>🎉 النتيجة النهائية:</h3>
        <textarea id="result" readonly></textarea>
    </div>

    <script>
        // فك التشفير باستخدام Base64
        function decodeBase64(data) {
            try {
                return atob(data);
            } catch {
                return "[Base64] ❌ خطأ: بيانات غير صالحة";
            }
        }

        // فك التشفير باستخدام URL
        function decodeURL(data) {
            try {
                return decodeURIComponent(data);
            } catch {
                return "[URL] ❌ خطأ: بيانات غير صالحة";
            }
        }

        // فك التشفير باستخدام Hex
        function decodeHex(data) {
            try {
                const hex = data.replace(/[^0-9a-fA-F]/g, '');
                if (hex.length % 2 !== 0) throw new Error();
                return hex.match(/.{2}/g).map(byte => String.fromCharCode(parseInt(byte, 16))).join('');
            } catch {
                return "[Hex] ❌ خطأ: بيانات غير صالحة";
            }
        }

        // فك التشفير باستخدام ROT13
        function decodeRot13(data) {
            return data.replace(/[a-zA-Z]/g, c =>
                String.fromCharCode(
                    (c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26
                )
            );
        }

        // تعريف العمليات
        const operations = {
            base64: decodeBase64,
            url: decodeURL,
            hex: decodeHex,
            rot13: decodeRot13,
        };

        // تنفيذ العمليات
        function run() {
            const input = document.getElementById("input").value.trim();
            const selectedOperations = Array.from(document.querySelectorAll("input[type=checkbox]:checked"))
                                            .map(cb => cb.value);

            if (!input) {
                alert("⚠️ الرجاء إدخال بيانات مشفرة!");
                return;
            }

            if (selectedOperations.length === 0) {
                alert("⚠️ الرجاء اختيار عملية واحدة على الأقل!");
                return;
            }

            let current = input;
            let outputSteps = "";

            for (const operation of selectedOperations) {
                const before = current;
                current = operations[operation](current);
                outputSteps += `
                    <div class="step">
                        <b>🔧 ${operation.toUpperCase()}</b><br>
                        <i>قبل:</i> ${before}<br>
                        <i>بعد:</i> ${current}<br><hr>
                    </div>
                `;
            }

            document.getElementById("steps").innerHTML = outputSteps;
            document.getElementById("result").value = current;
        }

        // ربط الزر بوظيفة التشغيل
        document.getElementById("runButton").addEventListener("click", run);
    </script>
</body>
</html>
